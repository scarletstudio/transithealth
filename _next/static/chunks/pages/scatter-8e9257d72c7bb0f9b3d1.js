(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[43],{2815:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(5893),a=n(7294),s=n(8911),c=n(2787),i=n(3909),o=n(1084);function l(e){var t=e.width?e.width:e.height?.8*e.height:300,n=e.height?e.height:e.width?e.width/.8:375,l=[t/2,n/2],u=t/300,d=n/375,h=e.scale||4e4*Math.max(u,d),m=e.offsetX||-.0475,f=(0,s.Z)(e.communityAreas),p=[f[0]+m,f[1]],j=(0,c.ZP)().center(p).scale(h).translate(l),x=e.defaultOpacity||1,v=e.onAreaClick?(0,o.D)(100,e.onAreaClick):null,b=e.onAreaHover?(0,o.D)(100,e.onAreaHover):null,y=e.communityAreas.features,g=e.data||{},N=(0,a.useState)(e.selectedAreaNumber),w=N[0],O=N[1];(0,a.useEffect)((function(){O(e.selectedAreaNumber)}),[e.selectedAreaNumber]);var C=["ChicagoMap",Object.keys(g).length>0?"HasData":"NoData"].join(" ");return(0,r.jsx)("div",{className:C,children:(0,r.jsx)("svg",{width:t,height:n,viewBox:"0 0 ".concat(t," ").concat(n),children:(0,r.jsx)("g",{className:"areas",children:y.map((function(e,t){var n=e.properties,a=g[n.number]||{};return(0,r.jsx)("path",{className:"CommunityArea ".concat(w===n.number?"Selected":""),d:(0,i.Z)().projection(j)(e),fill:a.fill,fillOpacity:a.opacity||x,onClick:function(e){O(n.number),v&&v(n)},onMouseEnter:function(e){b&&b(n)}},"path-".concat(t))}))})})})}},2874:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(5893),a=n(7329),s=n(7294);function c(e,t){var n=t.toLowerCase().trim();return 0===n.length?Object.keys(e):Object.keys(e).filter((function(t){return e[t].name.toLowerCase().indexOf(n)>-1}))}function i(e){var t=e.supportedMetrics,n=e.onClose,a=e.selectMetric,c=e.show,i=(0,s.useState)(""),l=i[0],u=i[1];if(!c)return null;var d=0===l.toLowerCase().trim().length?"Showing all Metrics":"Showing results for ".concat(l);return(0,r.jsx)("div",{className:"selectorModal",onClick:n,children:(0,r.jsxs)("div",{className:"modalContent",onClick:function(e){return e.stopPropagation()},children:[(0,r.jsx)("div",{className:"modalHeader",children:(0,r.jsx)("h4",{className:"modalTitle",children:"Select your Metric"})}),(0,r.jsxs)("div",{className:"modalBody",children:[(0,r.jsxs)("div",{className:"searchBar",children:[(0,r.jsxs)("p",{children:[" ",(0,r.jsx)("input",{type:"text",value:l,placeholder:"Search Metrics...",onChange:function(e){return u(e.target.value)}})," "]}),(0,r.jsx)("p",{children:d})]}),(0,r.jsx)(o,{searchText:l,supportedMetrics:t,onClose:n,selectMetric:a})]}),(0,r.jsx)("div",{className:"modalFooter",children:(0,r.jsx)("button",{className:"closeButton",onClick:n,children:"Close"})})]})})}function o(e){var t=e.searchText,n=e.supportedMetrics,s=e.onClose,i=e.selectMetric,o=(t.toLowerCase().trim(),c(n,t)),l=function(e,t){var n=(0,a.Z)(new Set(Object.keys(e).map((function(t){return e[t].dataset})))),r=t,s={};for(var c in n){var i=[];for(var o in t){var l=t[o];n[c]===e[l].dataset&&i.push(r[o])}s[n[c]]=i}return s}(n,o),u=function(e){for(var t=[],n=Object.entries(e),r=0;r<n.length;r++){var a=n[r],s=(a[0],{key:a[1]});t.push(s)}}(l);u=function(e){for(var t=Object.entries(e).sort((function(e,t){return t[1].length-e[1].length})),n=[],r=0;r<t.length;r++){var a=t[r],s={};s[a[0]]=a[1],n.push(s)}return n}(l);for(var d=[],h=0;h<u.length;h++){var m=function(){var e=l[f];for(p=0,j=0;j<o.length;j++)if(n[o[j]].dataset.indexOf(f)>-1&&p<1){d.push((0,r.jsx)("p",{className:"metricGroup",children:f},f));for(var t=function(t){o.indexOf(e[t])>-1&&d.push((0,r.jsxs)("div",{className:"metricResult",onClick:function(){i(e[t]),s()},children:[(0,r.jsx)("p",{className:"metric",children:n[e[t]].name}),(0,r.jsx)("div",{className:"metricMetaData",children:(0,r.jsxs)("p",{children:["Description: ",n[e[t]].description]})})]},e[t]))},a=0;a<e.length;a++)t(a);p++}};for(var f in u[h]){var p,j;m()}}return(0,r.jsx)("div",{className:"searchResults",children:d})}function l(e){var t=e.label,n=e.supportedMetrics,a=e.defaultValue,c=e.onChange,o=(0,s.useState)(0),l=o[0],u=o[1],d=(0,s.useState)(a),h=d[0],m=d[1];return(0,r.jsxs)("div",{className:"searchableMetricSelector",children:[(0,r.jsxs)("div",{className:"selectorBody",children:[t?(0,r.jsxs)("span",{className:"bold selectorLabel",children:[t,": "]}):null,(0,r.jsx)("button",{className:"selectorButton",onClick:function(){return u(1)},children:n[h].name})]}),(0,r.jsx)(i,{supportedMetrics:n,onClose:function(){return u(0)},selectMetric:function(e){c(e),m(e)},show:l})]})}},8811:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSG:function(){return T},default:function(){return B}});var r=n(5893),a=n(9008),s=n(9187),c=n(7757),i=n.n(c),o=n(6156),l=n(2137),u=n(7294),d=n(2815),h=n(2874),m=n(3743),f=n(9009),p=n(7478),j=n(4195),x=n(3023),v=n(5048),b=n(5358),y=n(9307),g=n(9746),N=n(3815);function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var C=m.fH,k=m.QA.metricX,S=m.QA.metricY;function A(e,t){return M.apply(this,arguments)}function M(){return(M=(0,l.Z)(i().mark((function e(t,n){var r,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("https://transithealth.herokuapp.com","/community/metrics"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({metrics:[t,n]})});case 2:return r=e.sent,e.next=5,r.json();case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.05,r=e.filter((function(e){return e[t]})).reduce((function(e,n){return Math.max(e,n[t])}),e[0][t]),a=e.reduce((function(e,a){var s=(a[t]||0)/r;return e[a.area_number]=O(O({},a),{},{opacity:Math.max(n,s)}),e}),{});return a}function Z(e){var t,n=e.active,a=e.payload,s=(e.label,e.metrics),c=(null===a||void 0===a||null===(t=a[0])||void 0===t?void 0:t.payload)||{},i=s.filter((function(e){return!(e in c)})).length>0;return n&&c&&!i?(0,r.jsxs)("div",{className:"CustomToolTip",children:[(0,r.jsx)("h4",{children:c.name}),(0,r.jsxs)("p",{children:["Community Area ",c.area_number," (",c.part,")"]}),s.map((function(e,t){return(0,r.jsxs)("p",{children:[(0,r.jsxs)("span",{children:[C[e].name,": "]}),(0,r.jsxs)("span",{children:[C[e].format(c[e])," "]}),(0,r.jsx)("span",{children:C[e].units})]},t)}))]}):null}function P(e){var t,n=e.data,a=e.metricX,s=e.metricY,c=e.width,i=e.height,l=e.onHover,u=e.selectedAreaData,d=C[a],h=C[s],m=n||[(t={},(0,o.Z)(t,a,0),(0,o.Z)(t,s,0),t)],w=function(e,t){var n="".concat(e.name," (").concat(e.units,")");return n.length<=t?n:n.slice(0,t)+"..."};return(0,r.jsx)(f.h,{width:c,height:i,children:(0,r.jsxs)(p.G,{margin:{left:50,right:10,bottom:30,top:30},children:[(0,r.jsx)(j.q,{strokeDasharray:"3 3"}),(0,r.jsx)(x.K,{dataKey:a,type:"number",tickFormatter:d.format,children:(0,r.jsx)(v._,{value:w(d,60),position:"bottom",offset:15})}),(0,r.jsx)(b.B,{dataKey:s,type:"number",tickFormatter:h.format,children:(0,r.jsx)(v._,{value:w(h,35),position:"left",angle:-90,offset:25,style:{textAnchor:"middle"}})}),(0,r.jsx)(y.u,{content:(0,r.jsx)(Z,{metrics:[a,s]})}),(0,r.jsx)(g.b,{name:"Community Area",data:m,onMouseOver:l,onMouseOut:function(){return l({area_number:-1})},children:m.map((function(e,t){var n=e.area_number===u.area_number?"selected":"";return(0,r.jsx)(N.b,{className:n},t)}))})]})})}function D(e){var t=e.communityAreas,n=(0,u.useState)(null),a=n[0],s=n[1],c=(0,u.useState)(k),o=c[0],m=c[1],f=(0,u.useState)(S),p=f[0],j=f[1],x=(0,u.useState)(!1),v=x[0],b=x[1],y=(0,u.useState)(-1),g=y[0],N=y[1],w=(0,u.useState)({}),O=w[0],M=w[1],Z=O[g]||{},D=C[o],E=C[p];return(0,u.useEffect)((function(){var e=!0;function t(){return(t=(0,l.Z)(i().mark((function t(){var n,r;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return b(!0),t.next=3,A(o,p);case 3:n=t.sent,r=_(n.metrics,p),e&&(s(n.metrics),M(r),b(!1));case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return N(-1),M({}),function(){t.apply(this,arguments)}(),function(){return e=!1}}),[o,p]),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{children:O&&g>0?Z.name:"By Community Area"}),(0,r.jsxs)("div",{className:"SelectorContainer",children:[(0,r.jsx)(h.Z,{label:"X Axis",supportedMetrics:C,defaultValue:o,onChange:m}),(0,r.jsx)("span",{children:Z[o]?"".concat(D.fullFormat(Z[o])," ").concat(D.units):""}),(0,r.jsx)("span",{className:"spacer",children:" "}),(0,r.jsx)("br",{}),(0,r.jsx)(h.Z,{label:"Y Axis",supportedMetrics:C,defaultValue:p,onChange:j}),(0,r.jsx)("span",{children:Z[p]?"".concat(E.fullFormat(Z[p])," ").concat(E.units):""}),(0,r.jsx)("span",{className:"spacer",children:" "}),(0,r.jsx)("span",{children:v?"Loading data...":""})]}),(0,r.jsxs)("div",{className:"PlotRow",children:[(0,r.jsx)(P,{data:a,metricX:o,metricY:p,width:"65%",height:450,onHover:function(e){e.area_number!==g&&N(e.area_number)},selectedAreaData:Z}),(0,r.jsxs)("div",{className:"ScatterMap",children:[(0,r.jsx)(d.Z,{data:O,communityAreas:t,height:410,defaultOpacity:1,selectedAreaNumber:g,onAreaClick:function(e){e.number!==g&&N(e.number)}}),(0,r.jsx)("p",{className:"center MapLabel",children:E.name})]})]})]})}var E=n(8047),T=!0;function B(e){var t=e.communityAreas;return(0,r.jsxs)("div",{children:[(0,r.jsxs)(a.default,{children:[(0,r.jsx)("title",{children:"TransitHealth"}),(0,r.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,r.jsx)("meta",{name:"description",content:"Explore transit and public health data across Chicago."}),(0,r.jsx)("link",{rel:"icon",href:"favicon.ico"})]}),(0,r.jsx)(s.Z,{}),(0,r.jsx)("main",{className:"Scatter",children:(0,r.jsxs)("div",{className:"page",children:[(0,r.jsx)("div",{className:"center",children:(0,r.jsx)("h1",{children:"Scatter View"})}),(0,r.jsx)(D,{communityAreas:t})]})}),(0,r.jsx)(E.k7,{})]})}},5624:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/scatter",function(){return n(8811)}])}},function(e){e.O(0,[774,351,197,238,376,478,306],(function(){return t=5624,e(e.s=t);var t}));var t=e.O();_N_E=t}]);